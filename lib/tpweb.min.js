!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("tpweb",[],t):"object"==typeof exports?exports.tpweb=t():e.tpweb=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}var t,n,o;return t=e,(n=[{key:"encode",value:function(e){var t,n,r,o,u,i,f,a="",c=0;for(e=this._utf8Encode(e);c<e.length;)o=(t=e.charCodeAt(c++))>>2,u=(3&t)<<4|(n=e.charCodeAt(c++))>>4,i=(15&n)<<2|(r=e.charCodeAt(c++))>>6,f=63&r,isNaN(n)?i=f=64:isNaN(r)&&(f=64),a=a+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(i)+this._keyStr.charAt(f);return a}},{key:"decode",value:function(e){var t,n,r,o,u,i,f="",a=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");a<e.length;)t=this._keyStr.indexOf(e.charAt(a++))<<2|(o=this._keyStr.indexOf(e.charAt(a++)))>>4,n=(15&o)<<4|(u=this._keyStr.indexOf(e.charAt(a++)))>>2,r=(3&u)<<6|(i=this._keyStr.indexOf(e.charAt(a++))),f+=String.fromCharCode(t),64!==u&&(f+=String.fromCharCode(n)),64!==i&&(f+=String.fromCharCode(r));return f=this._utf8Decode(f)}},{key:"_utf8Encode",value:function(e){var t="";e=e.replace(/\r\n/g,"\n");for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}},{key:"_utf8Decode",value:function(e){for(var t="",n=0,r=0,o=0,u=0;n<e.length;)(r=e.charCodeAt(n))<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(o=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),u=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&o)<<6|63&u),n+=3);return t}}])&&r(t.prototype,n),o&&r(t,o),e}();t.default=o,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"TpSocket",{enumerable:!0,get:function(){return o.default}});var r,o=(r=n(2))&&r.__esModule?r:{default:r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(n(0)),o=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name="Barra-Tempest"}var t,n,u;return t=e,(n=[{key:"name",get:function(){return this._name}},{key:"encodedName",get:function(){return(new r.default).encode(this._name)}},{key:"saluta",get:function(){return o.default.greetme()}}])&&i(t.prototype,n),u&&i(t,u),e}();t.default=f,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e={},t=null,n="base64",u=[],f=0,a=1e4,c=[],l={message:function(){},open:function(){},close:function(){},error:function(){}},s=!1;function d(){return"ciccamelo! uno a zero!"}function p(){return c}function b(){return u}function y(){return f}function h(e){f=e}function g(){return u.length-f}function m(){return u[f]}function v(){return u[f++]}function S(e){0===f?u.unshift(e):u[f-=1]=e}function _(){return(u[f++]<<8)+u[f++]}function C(){return(u[f++]<<24)+(u[f++]<<16)+(u[f++]<<8)+u[f++]}function k(e){void 0===e&&(e=g());var t=u.slice(f,f+e);return f+=e,String.fromCharCode.apply(null,t)}function A(e){return void 0===e&&(e=g()),f+=e,u.slice(f-e,f)}function w(e,t){return t?u.slice(f+e,f+t):u.slice(f+e)}function x(e,t,n){var r=u.length-f;if(r<t){if(n){if(f<n)throw new Error("rQwait cannot backup "+n+" bytes");f-=n}return!0}return!1}function O(){return 0!==t.bufferedAmount&&o.default.Debug("bufferedAmount: "+t.bufferedAmount),t.bufferedAmount<e.maxBufferedAmount?(c.length>0&&(t.send(function(){if("binary"===n)return new Uint8Array(c).buffer;return r.default.encode(c)}()),c=[]),!0):(o.default.Info("Delaying send, bufferedAmount: "+t.bufferedAmount),!1)}function j(e){return c=c.concat(e),O()}function W(t){e.send(t.split("").map(function(e){return e.charCodeAt(0)}))}function Q(e){try{!function(e){if("binary"===n)for(var t=new Uint8Array(e),o=0;o<t.length;o++)u.push(t[o]);else u=u.concat(r.default.decode(e,0))}(e.data),g()>0?(l.message(),u.length>a&&(u=u.slice(f),f=0)):o.default.Debug("Ignoring empty message")}catch(e){void 0!==e.stack?o.default.Warn("recv_message, caught exception: "+e.stack):void 0!==e.description?o.default.Warn("recv_message, caught exception: "+e.description):o.default.Warn("recv_message, caught exception:"+e),void 0!==e.name?l.error(e.name+": "+e.message):l.error(e)}}function P(e,t){l[e]=t}function M(e,n){var r=!1,a=!1;u=[],f=0,c=[],t=null,"Uint8Array"in window&&"set"in Uint8Array.prototype&&(r=!0);try{r&&("binaryType"in WebSocket.prototype||new WebSocket(n+"://.").binaryType)&&(o.default.Info("Detected binaryType support in WebSockets"),a=!0)}catch(e){}if(void 0===e&&(e=a?["binary","base64"]:"base64"),!a){if("binary"===e)throw new Error("WebSocket binary sub-protocol requested but not supported");if("object"===i(e)){for(var l=[],s=0;s<e.length;s++)"binary"===e[s]?o.default.Error("Skipping unsupported WebSocket binary sub-protocol"):l.push(e[s]);if(!(l.length>0))throw new Error("Only WebSocket binary sub-protocol was requested and not supported.");e=l}}return e}function D(e,r){var u=e.match(/^([a-z]+):\/\//)[1];r=M(r,u),s?t={}:(t=new WebSocket(e,r),r.indexOf("binary")>=0&&(t.binaryType="arraybuffer")),t.onmessage=Q,t.onopen=function(){o.default.Debug(">> WebSock.onopen"),t.protocol?(n=t.protocol,o.default.Info("Server chose sub-protocol: "+t.protocol)):(n="base64",o.default.Error("Server select no sub-protocol!: "+t.protocol)),l.open(),o.default.Debug('"<< WebSock.onopen')},t.onclose=function(e){o.default.Debug(">> WebSock.onclose"),l.close(e),o.default.Debug("<< WebSock.onclose")},t.onerror=function(e){o.default.Debug(">> WebSock.onerror: "+e),l.error(e),o.default.Debug("<< WebSock.onerror")}}function E(){t&&(t.readyState!==WebSocket.OPEN&&t.readyState!==WebSocket.CONNECTING||(o.default.Info("Closing WebSocket connection"),t.close()),t.onmessage=function(e){})}function T(t,r){return s=!0,n=r,e.send=t,e.close=function(){},Q}return e.maxBufferedAmount=200,e.get_sQ=p,e.get_rQ=b,e.get_rQi=y,e.set_rQi=h,e.rQlen=g,e.rQpeek8=m,e.rQshift8=v,e.rQunshift8=S,e.rQshift16=_,e.rQshift32=C,e.rQshiftStr=k,e.rQshiftBytes=A,e.rQslice=w,e.rQwait=x,e.flush=O,e.send=j,e.send_string=W,e.on=P,e.init=M,e.open=D,e.close=E,e.testMode=T,console.log(d),e};var r=u(n(0)),o=u(n(4));function u(e){return e&&e.__esModule?e:{default:e}}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},e.exports=t.default}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90cHdlYi93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vdHB3ZWIvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdHB3ZWIvLi9zcmMvYmFzZTY0LmpzIiwid2VicGFjazovL3Rwd2ViLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3Rwd2ViLy4vc3JjL3Rwc29ja2V0LmpzIiwid2VicGFjazovL3Rwd2ViLy4vc3JjL3dlYnNvY2suanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwic2VsZiIsInRoaXMiLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiQmFzZTY0IiwiX2NsYXNzQ2FsbENoZWNrIiwiX2tleVN0ciIsImlucHV0IiwiY2hyMSIsImNocjIiLCJjaHIzIiwiZW5jMSIsImVuYzIiLCJlbmMzIiwiZW5jNCIsIm91dHB1dCIsIl91dGY4RW5jb2RlIiwibGVuZ3RoIiwiY2hhckNvZGVBdCIsImlzTmFOIiwiY2hhckF0IiwicmVwbGFjZSIsImluZGV4T2YiLCJTdHJpbmciLCJmcm9tQ2hhckNvZGUiLCJfdXRmOERlY29kZSIsInN0cmluZyIsInV0ZnRleHQiLCJjMiIsImMzIiwiX3Rwc29ja2V0IiwiX2Jhc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3dlYnNvY2siLCJUcFNvY2tldCIsIl9uYW1lIiwiZGVmYXVsdCIsImVuY29kZSIsImdyZWV0bWUiLCJhcGkiLCJ3ZWJzb2NrZXQiLCJyUSIsInJRaSIsInJRbWF4Iiwic1EiLCJldmVudEhhbmRsZXJzIiwibWVzc2FnZSIsIm9wZW4iLCJjbG9zZSIsImVycm9yIiwidGVzdF9tb2RlIiwiZ2V0X3NRIiwiZ2V0X3JRIiwiZ2V0X3JRaSIsInNldF9yUWkiLCJ2YWwiLCJyUWxlbiIsInJRcGVlazgiLCJyUXNoaWZ0OCIsInJRdW5zaGlmdDgiLCJudW0iLCJ1bnNoaWZ0IiwiclFzaGlmdDE2IiwiclFzaGlmdDMyIiwiclFzaGlmdFN0ciIsImxlbiIsImFyciIsInNsaWNlIiwiYXBwbHkiLCJyUXNoaWZ0Qnl0ZXMiLCJyUXNsaWNlIiwic3RhcnQiLCJlbmQiLCJyUXdhaXQiLCJtc2ciLCJnb2JhY2siLCJFcnJvciIsImZsdXNoIiwiYnVmZmVyZWRBbW91bnQiLCJfdXRpbCIsIkRlYnVnIiwibWF4QnVmZmVyZWRBbW91bnQiLCJzZW5kIiwiVWludDhBcnJheSIsImJ1ZmZlciIsImVuY29kZV9tZXNzYWdlIiwiSW5mbyIsImNvbmNhdCIsInNlbmRfc3RyaW5nIiwic3RyIiwic3BsaXQiLCJtYXAiLCJjaHIiLCJyZWN2X21lc3NhZ2UiLCJlIiwiZGF0YSIsInU4IiwicHVzaCIsImRlY29kZSIsImRlY29kZV9tZXNzYWdlIiwiZXhjIiwic3RhY2siLCJXYXJuIiwiZGVzY3JpcHRpb24iLCJvbiIsImV2dCIsImhhbmRsZXIiLCJpbml0IiwicHJvdG9jb2xzIiwid3Nfc2NoZW1hIiwiYnQiLCJ3c2J0Iiwid2luZG93IiwiV2ViU29ja2V0IiwiYmluYXJ5VHlwZSIsIl90eXBlb2YiLCJuZXdfcHJvdG9jb2xzIiwidXJpIiwibWF0Y2giLCJvbm1lc3NhZ2UiLCJvbm9wZW4iLCJwcm90b2NvbCIsIm9uY2xvc2UiLCJvbmVycm9yIiwicmVhZHlTdGF0ZSIsIk9QRU4iLCJDT05ORUNUSU5HIiwi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RUFBSWMsUUFBZUEsRUFDbkJkLEVBQUllLFFBQWVBLEVBR25CZixFQUFJaUIsTUFBZUEsRUFDbkJqQixFQUFJa0IsUUFBZUEsRUFDbkJsQixFQUFJbUIsU0FBZUEsRUFDbkJuQixFQUFJb0IsV0FBZUEsRUFDbkJwQixFQUFJdUIsVUFBZUEsRUFDbkJ2QixFQUFJd0IsVUFBZUEsRUFDbkJ4QixFQUFJeUIsV0FBZUEsRUFDbkJ6QixFQUFJOEIsYUFBZUEsRUFDbkI5QixFQUFJK0IsUUFBZUEsRUFDbkIvQixFQUFJa0MsT0FBZUEsRUFFbkJsQyxFQUFJc0MsTUFBZUEsRUFDbkJ0QyxFQUFJMkMsS0FBZUEsRUFDbkIzQyxFQUFJaUQsWUFBZUEsRUFFbkJqRCxFQUFJaUUsR0FBZUEsRUFDbkJqRSxFQUFJb0UsS0FBZUEsRUFDbkJwRSxFQUFJUSxLQUFlQSxFQUNuQlIsRUFBSVMsTUFBZUEsRUFDbkJULEVBQUl3RixTQUFlQSxFQUVuQkcsUUFBUUMsSUFBSTdGLEdBRUxDLEdBOVdYLElBQUFSLEVBQUFDLEVBQUE5RCxFQUFBLElBQ0E2RyxFQUFBL0MsRUFBQTlELEVBQUEiLCJmaWxlIjoidHB3ZWIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJ0cHdlYlwiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJ0cHdlYlwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJ0cHdlYlwiXSA9IGZhY3RvcnkoKTtcbn0pKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCIvKipcbipcbiogIEJhc2U2NCBlbmNvZGUgLyBkZWNvZGVcbiogIGh0dHA6Ly93d3cud2VidG9vbGtpdC5pbmZvL1xuKlxuKiovXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhc2U2NCB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuX2tleVN0ciA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSc7XG4gIH1cbiAgLy8gcHVibGljIG1ldGhvZCBmb3IgZW5jb2RpbmdcbiAgZW5jb2RlKGlucHV0KSB7XG4gICAgdmFyIG91dHB1dCA9ICcnO1xuICAgIHZhciBjaHIxLCBjaHIyLCBjaHIzLCBlbmMxLCBlbmMyLCBlbmMzLCBlbmM0O1xuICAgIHZhciBpID0gMDtcblxuICAgIGlucHV0ID0gdGhpcy5fdXRmOEVuY29kZShpbnB1dCk7XG4gICAgd2hpbGUgKGkgPCBpbnB1dC5sZW5ndGgpIHtcbiAgICAgIGNocjEgPSBpbnB1dC5jaGFyQ29kZUF0KGkrKyk7XG4gICAgICBjaHIyID0gaW5wdXQuY2hhckNvZGVBdChpKyspO1xuICAgICAgY2hyMyA9IGlucHV0LmNoYXJDb2RlQXQoaSsrKTtcblxuICAgICAgZW5jMSA9IGNocjEgPj4gMjtcbiAgICAgIGVuYzIgPSAoKGNocjEgJiAzKSA8PCA0KSB8IChjaHIyID4+IDQpO1xuICAgICAgZW5jMyA9ICgoY2hyMiAmIDE1KSA8PCAyKSB8IChjaHIzID4+IDYpO1xuICAgICAgZW5jNCA9IGNocjMgJiA2MztcblxuICAgICAgaWYgKGlzTmFOKGNocjIpKSB7XG4gICAgICAgIGVuYzMgPSBlbmM0ID0gNjQ7XG4gICAgICB9IGVsc2UgaWYgKGlzTmFOKGNocjMpKSB7XG4gICAgICAgIGVuYzQgPSA2NDtcbiAgICAgIH1cbiAgICAgIG91dHB1dCA9IG91dHB1dCArXG4gICAgICB0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzEpICsgdGhpcy5fa2V5U3RyLmNoYXJBdChlbmMyKSArXG4gICAgICB0aGlzLl9rZXlTdHIuY2hhckF0KGVuYzMpICsgdGhpcy5fa2V5U3RyLmNoYXJBdChlbmM0KTtcbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxuXG4gIC8vIHB1YmxpYyBtZXRob2QgZm9yIGRlY29kaW5nXG4gIGRlY29kZShpbnB1dCkge1xuICAgIHZhciBvdXRwdXQgPSAnJztcbiAgICB2YXIgY2hyMSwgY2hyMiwgY2hyMztcbiAgICB2YXIgZW5jMSwgZW5jMiwgZW5jMywgZW5jNDtcbiAgICB2YXIgaSA9IDA7XG5cbiAgICBpbnB1dCA9IGlucHV0LnJlcGxhY2UoL1teQS1aYS16MC05XFwrXFwvXFw9XS9nLCAnJyk7XG5cbiAgICB3aGlsZSAoaSA8IGlucHV0Lmxlbmd0aCkge1xuXG4gICAgICBlbmMxID0gdGhpcy5fa2V5U3RyLmluZGV4T2YoaW5wdXQuY2hhckF0KGkrKykpO1xuICAgICAgZW5jMiA9IHRoaXMuX2tleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtcbiAgICAgIGVuYzMgPSB0aGlzLl9rZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7XG4gICAgICBlbmM0ID0gdGhpcy5fa2V5U3RyLmluZGV4T2YoaW5wdXQuY2hhckF0KGkrKykpO1xuXG4gICAgICBjaHIxID0gKGVuYzEgPDwgMikgfCAoZW5jMiA+PiA0KTtcbiAgICAgIGNocjIgPSAoKGVuYzIgJiAxNSkgPDwgNCkgfCAoZW5jMyA+PiAyKTtcbiAgICAgIGNocjMgPSAoKGVuYzMgJiAzKSA8PCA2KSB8IGVuYzQ7XG5cbiAgICAgIG91dHB1dCA9IG91dHB1dCArIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hyMSk7XG5cbiAgICAgIGlmIChlbmMzICE9PSA2NCkge1xuICAgICAgICBvdXRwdXQgPSBvdXRwdXQgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjIpO1xuICAgICAgfVxuICAgICAgaWYgKGVuYzQgIT09IDY0KSB7XG4gICAgICAgIG91dHB1dCA9IG91dHB1dCArIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hyMyk7XG4gICAgICB9XG4gICAgfVxuICAgIG91dHB1dCA9IHRoaXMuX3V0ZjhEZWNvZGUob3V0cHV0KTtcbiAgICByZXR1cm4gb3V0cHV0O1xuICB9XG5cbiAgLy8gcHJpdmF0ZSBtZXRob2QgZm9yIFVURi04IGVuY29kaW5nXG4gIF91dGY4RW5jb2RlKHN0cmluZykge1xuICAgIHZhciB1dGZ0ZXh0ID0gJyc7XG5cbiAgICBzdHJpbmcgPSBzdHJpbmcucmVwbGFjZSgvXFxyXFxuL2csICdcXG4nKTtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHN0cmluZy5sZW5ndGg7IG4rKykge1xuICAgICAgbGV0IGMgPSBzdHJpbmcuY2hhckNvZGVBdChuKTtcblxuICAgICAgaWYgKGMgPCAxMjgpIHtcbiAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpO1xuICAgICAgfSBlbHNlIGlmICgoYyA+IDEyNykgJiYgKGMgPCAyMDQ4KSkge1xuICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgPj4gNikgfCAxOTIpO1xuICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXRmdGV4dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKChjID4+IDEyKSB8IDIyNCk7XG4gICAgICAgIHV0ZnRleHQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoKGMgPj4gNikgJiA2MykgfCAxMjgpO1xuICAgICAgICB1dGZ0ZXh0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKGMgJiA2MykgfCAxMjgpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdXRmdGV4dDtcbiAgfVxuXG4gIC8vIHByaXZhdGUgbWV0aG9kIGZvciBVVEYtOCBkZWNvZGluZ1xuICBfdXRmOERlY29kZSh1dGZ0ZXh0KSB7XG4gICAgdmFyIHN0cmluZyA9ICcnO1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIgYyA9IDA7XG4gICAgdmFyIGMyID0gMDtcbiAgICB2YXIgYzMgPSAwO1xuXG4gICAgd2hpbGUgKGkgPCB1dGZ0ZXh0Lmxlbmd0aCkge1xuICAgICAgYyA9IHV0ZnRleHQuY2hhckNvZGVBdChpKTtcbiAgICAgIGlmIChjIDwgMTI4KSB7XG4gICAgICAgIHN0cmluZyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGMpO1xuICAgICAgICBpKys7XG4gICAgICB9IGVsc2UgaWYgKChjID4gMTkxKSAmJiAoYyA8IDIyNCkpIHtcbiAgICAgICAgYzIgPSB1dGZ0ZXh0LmNoYXJDb2RlQXQoaSArIDEpO1xuICAgICAgICBzdHJpbmcgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgoKGMgJiAzMSkgPDwgNikgfCAoYzIgJiA2MykpO1xuICAgICAgICBpICs9IDI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjMiA9IHV0ZnRleHQuY2hhckNvZGVBdChpICsgMSk7XG4gICAgICAgIGMzID0gdXRmdGV4dC5jaGFyQ29kZUF0KGkgKyAyKTtcbiAgICAgICAgc3RyaW5nICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjICYgMTUpIDw8IDEyKSB8ICgoYzIgJiA2MykgPDwgNikgfCAoYzMgJiA2MykpO1xuICAgICAgICBpICs9IDM7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzdHJpbmc7XG4gIH1cbn1cbiIsImltcG9ydCBUcFNvY2tldCBmcm9tICcuL3Rwc29ja2V0LmpzJztcbmV4cG9ydCB7IFRwU29ja2V0IH07XG4iLCJpbXBvcnQgQmFzZTY0IGZyb20gJy4vYmFzZTY0JztcbmltcG9ydCBXZWJzb2NrIGZyb20gJy4vd2Vic29jayc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRwU29ja2V0IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5fbmFtZSA9ICdCYXJyYS1UZW1wZXN0JztcbiAgfVxuICBnZXQgbmFtZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgfVxuXG4gIGdldCBlbmNvZGVkTmFtZSgpIHtcbiAgICBsZXQgYjY0ID0gbmV3IEJhc2U2NCgpO1xuXG4gICAgcmV0dXJuIGI2NC5lbmNvZGUodGhpcy5fbmFtZSk7XG4gIH1cblxuICBnZXQgc2FsdXRhKCkge1xuICAgIHJldHVybiBXZWJzb2NrLmdyZWV0bWUoKTtcbiAgfVxufVxuIiwiLyogZXNsaW50IGNhbWVsY2FzZTowIG5vLW11bHRpLXNwYWNlczowICovXG5pbXBvcnQgQmFzZTY0IGZyb20gJy4vYmFzZTY0JztcbmltcG9ydCBVdGlsIGZyb20gJy4vdXRpbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFdlYnNvY2soKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICB2YXIgYXBpID0ge30sICAgICAgIC8vIFB1YmxpYyBBUElcbiAgICB3ZWJzb2NrZXQgPSBudWxsLCAvLyBXZWJTb2NrZXQgb2JqZWN0XG4gICAgbW9kZSA9ICdiYXNlNjQnLCAgLy8gQ3VycmVudCBXZWJTb2NrZXQgbW9kZTogJ2JpbmFyeScsICdiYXNlNjQnXG4gICAgclEgPSBbXSwgICAgICAgICAgLy8gUmVjZWl2ZSBxdWV1ZVxuICAgIHJRaSA9IDAsICAgICAgICAgIC8vIFJlY2VpdmUgcXVldWUgaW5kZXhcbiAgICByUW1heCA9IDEwMDAwLCAgICAvLyBNYXggcmVjZWl2ZSBxdWV1ZSBzaXplIGJlZm9yZSBjb21wYWN0aW5nXG4gICAgc1EgPSBbXSwgICAgICAgICAgLy8gU2VuZCBxdWV1ZVxuICAgIGV2ZW50SGFuZGxlcnMgPSB7XG4gICAgICAnbWVzc2FnZSc6IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgJ29wZW4nOiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgICdjbG9zZSc6IGZ1bmN0aW9uICgpIHt9LFxuICAgICAgJ2Vycm9yJzogZnVuY3Rpb24gKCkge31cbiAgICB9LFxuICAgIHRlc3RfbW9kZSA9IGZhbHNlO1xuXG4gIC8vXG4gIC8vIFF1ZXVlIHB1YmxpYyBmdW5jdGlvbnNcbiAgLy9cbiAgZnVuY3Rpb24gZ3JlZXRtZSgpIHtcbiAgICByZXR1cm4gJ2NpY2NhbWVsbyEgdW5vIGEgemVybyEnO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0X3NRKCkge1xuICAgIHJldHVybiBzUTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGdldF9yUSgpIHtcbiAgICByZXR1cm4gclE7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0X3JRaSgpIHtcbiAgICByZXR1cm4gclFpO1xuICB9XG4gIGZ1bmN0aW9uIHNldF9yUWkodmFsKSB7XG4gICAgclFpID0gdmFsO1xuICB9XG5cbiAgZnVuY3Rpb24gclFsZW4oKSB7XG4gICAgcmV0dXJuIHJRLmxlbmd0aCAtIHJRaTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJRcGVlazgoKSB7XG4gICAgcmV0dXJuIChyUVtyUWldKTtcbiAgfVxuICBmdW5jdGlvbiByUXNoaWZ0OCgpIHtcbiAgICByZXR1cm4gKHJRW3JRaSsrXSk7XG4gIH1cbiAgZnVuY3Rpb24gclF1bnNoaWZ0OChudW0pIHtcbiAgICBpZiAoclFpID09PSAwKSB7XG4gICAgICByUS51bnNoaWZ0KG51bSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJRaSAtPSAxO1xuICAgICAgclFbclFpXSA9IG51bTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gclFzaGlmdDE2KCkge1xuICAgIHJldHVybiAoclFbclFpKytdIDw8IDgpICtcbiAgICAgICAgICAgKHJRW3JRaSsrXSk7XG4gIH1cbiAgZnVuY3Rpb24gclFzaGlmdDMyKCkge1xuICAgIHJldHVybiAoclFbclFpKytdIDw8IDI0KSArXG4gICAgICAgICAgIChyUVtyUWkrK10gPDwgMTYpICtcbiAgICAgICAgICAgKHJRW3JRaSsrXSA8PCA4KSArXG4gICAgICAgICAgIChyUVtyUWkrK10pO1xuICB9XG4gIGZ1bmN0aW9uIHJRc2hpZnRTdHIobGVuKSB7XG4gICAgaWYgKHR5cGVvZiAobGVuKSA9PT0gJ3VuZGVmaW5lZCcpIHsgbGVuID0gclFsZW4oKTsgfVxuICAgIGxldCBhcnIgPSByUS5zbGljZShyUWksIHJRaSArIGxlbik7XG5cbiAgICByUWkgKz0gbGVuO1xuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGFycik7XG4gIH1cbiAgZnVuY3Rpb24gclFzaGlmdEJ5dGVzKGxlbikge1xuICAgIGlmICh0eXBlb2YgKGxlbikgPT09ICd1bmRlZmluZWQnKSB7IGxlbiA9IHJRbGVuKCk7IH1cbiAgICByUWkgKz0gbGVuO1xuICAgIHJldHVybiByUS5zbGljZShyUWkgLSBsZW4sIHJRaSk7XG4gIH1cblxuICBmdW5jdGlvbiByUXNsaWNlKHN0YXJ0LCBlbmQpIHtcbiAgICBpZiAoZW5kKSB7XG4gICAgICByZXR1cm4gclEuc2xpY2UoclFpICsgc3RhcnQsIHJRaSArIGVuZCk7XG4gICAgfVxuICAgIHJldHVybiByUS5zbGljZShyUWkgKyBzdGFydCk7XG4gIH1cblxuICAvLyBDaGVjayB0byBzZWUgaWYgd2UgbXVzdCB3YWl0IGZvciAnbnVtJyBieXRlcyAoZGVmYXVsdCB0byBGQlUuYnl0ZXMpXG4gIC8vIHRvIGJlIGF2YWlsYWJsZSBpbiB0aGUgcmVjZWl2ZSBxdWV1ZS4gUmV0dXJuIHRydWUgaWYgd2UgbmVlZCB0b1xuICAvLyB3YWl0IChhbmQgcG9zc2libHkgcHJpbnQgYSBkZWJ1ZyBtZXNzYWdlKSwgb3RoZXJ3aXNlIGZhbHNlLlxuICBmdW5jdGlvbiByUXdhaXQobXNnLCBudW0sIGdvYmFjaykge1xuICAgIHZhciByUWxlbiA9IHJRLmxlbmd0aCAtIHJRaTsgLy8gU2tpcCByUWxlbigpIGZ1bmN0aW9uIGNhbGxcblxuICAgIGlmIChyUWxlbiA8IG51bSkge1xuICAgICAgaWYgKGdvYmFjaykge1xuICAgICAgICBpZiAoclFpIDwgZ29iYWNrKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdyUXdhaXQgY2Fubm90IGJhY2t1cCAnICsgZ29iYWNrICsgJyBieXRlcycpO1xuICAgICAgICB9XG4gICAgICAgIHJRaSAtPSBnb2JhY2s7XG4gICAgICB9XG4gICAgICAvLyBVdGlsLkRlYnVnKFwiICAgd2FpdGluZyBmb3IgXCIgKyAobnVtLXJRbGVuKSArXG4gICAgICAvLyAgICAgICAgICAgXCIgXCIgKyBtc2cgKyBcIiBieXRlKHMpXCIpO1xuICAgICAgcmV0dXJuIHRydWU7ICAvLyB0cnVlIG1lYW5zIG5lZWQgbW9yZSBkYXRhXG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vXG4gIC8vIFByaXZhdGUgdXRpbGl0eSByb3V0aW5lc1xuICAvL1xuXG4gIGZ1bmN0aW9uIGVuY29kZV9tZXNzYWdlKCkge1xuICAgIGlmIChtb2RlID09PSAnYmluYXJ5Jykge1xuICAgICAgLy8gUHV0IGluIGEgYmluYXJ5IGFycmF5YnVmZmVyXG4gICAgICByZXR1cm4gKG5ldyBVaW50OEFycmF5KHNRKSkuYnVmZmVyO1xuICAgIH1cbiAgICAvLyBiYXNlNjQgZW5jb2RlXG4gICAgcmV0dXJuIEJhc2U2NC5lbmNvZGUoc1EpO1xuICB9XG5cbiAgZnVuY3Rpb24gZGVjb2RlX21lc3NhZ2UoZGF0YSkge1xuICAgIC8vIFV0aWwuRGVidWcoXCI+PiBkZWNvZGVfbWVzc2FnZTogXCIgKyBkYXRhKTtcbiAgICBpZiAobW9kZSA9PT0gJ2JpbmFyeScpIHtcbiAgICAgIC8vIHB1c2ggYXJyYXlidWZmZXIgdmFsdWVzIG9udG8gdGhlIGVuZFxuICAgICAgbGV0IHU4ID0gbmV3IFVpbnQ4QXJyYXkoZGF0YSk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdTgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgclEucHVzaCh1OFtpXSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGJhc2U2NCBkZWNvZGUgYW5kIGNvbmNhdCB0byB0aGUgZW5kXG4gICAgICByUSA9IHJRLmNvbmNhdChCYXNlNjQuZGVjb2RlKGRhdGEsIDApKTtcbiAgICB9XG4gICAgLy8gVXRpbC5EZWJ1ZyhcIj4+IGRlY29kZV9tZXNzYWdlLCByUTogXCIgKyByUSk7XG4gIH1cblxuICAvL1xuICAvLyBQdWJsaWMgU2VuZCBmdW5jdGlvbnNcbiAgLy9cblxuICBmdW5jdGlvbiBmbHVzaCgpIHtcbiAgICBpZiAod2Vic29ja2V0LmJ1ZmZlcmVkQW1vdW50ICE9PSAwKSB7XG4gICAgICBVdGlsLkRlYnVnKCdidWZmZXJlZEFtb3VudDogJyArIHdlYnNvY2tldC5idWZmZXJlZEFtb3VudCk7XG4gICAgfVxuICAgIGlmICh3ZWJzb2NrZXQuYnVmZmVyZWRBbW91bnQgPCBhcGkubWF4QnVmZmVyZWRBbW91bnQpIHtcbiAgICAgIC8vIFV0aWwuRGVidWcoXCJhcnI6IFwiICsgYXJyKTtcbiAgICAgIC8vIFV0aWwuRGVidWcoXCJzUTogXCIgKyBzUSk7XG4gICAgICBpZiAoc1EubGVuZ3RoID4gMCkge1xuICAgICAgICB3ZWJzb2NrZXQuc2VuZChlbmNvZGVfbWVzc2FnZShzUSkpO1xuICAgICAgICBzUSA9IFtdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIFV0aWwuSW5mbygnRGVsYXlpbmcgc2VuZCwgYnVmZmVyZWRBbW91bnQ6ICcgKyB3ZWJzb2NrZXQuYnVmZmVyZWRBbW91bnQpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIG92ZXJyaWRhYmxlIGZvciB0ZXN0aW5nXG4gIGZ1bmN0aW9uIHNlbmQoYXJyKSB7XG4gICAgLy8gVXRpbC5EZWJ1ZyhcIj4+IHNlbmRfYXJyYXk6IFwiICsgYXJyKTtcbiAgICBzUSA9IHNRLmNvbmNhdChhcnIpO1xuICAgIHJldHVybiBmbHVzaCgpO1xuICB9XG5cbiAgZnVuY3Rpb24gc2VuZF9zdHJpbmcoc3RyKSB7XG4gICAgLy8gVXRpbC5EZWJ1ZyhcIj4+IHNlbmRfc3RyaW5nOiBcIiArIHN0cik7XG4gICAgYXBpLnNlbmQoc3RyLnNwbGl0KCcnKS5tYXAoXG4gICAgICBmdW5jdGlvbiAoY2hyKSB7IHJldHVybiBjaHIuY2hhckNvZGVBdCgwKTsgfSkpO1xuICB9XG5cbiAgLy9cbiAgLy8gT3RoZXIgcHVibGljIGZ1bmN0aW9uc1xuXG4gIGZ1bmN0aW9uIHJlY3ZfbWVzc2FnZShlKSB7XG4gICAgLy8gVXRpbC5EZWJ1ZyhcIj4+IHJlY3ZfbWVzc2FnZTogXCIgKyBlLmRhdGEubGVuZ3RoKTtcbiAgICB0cnkge1xuICAgICAgZGVjb2RlX21lc3NhZ2UoZS5kYXRhKTtcbiAgICAgIGlmIChyUWxlbigpID4gMCkge1xuICAgICAgICBldmVudEhhbmRsZXJzLm1lc3NhZ2UoKTtcbiAgICAgICAgLy8gQ29tcGFjdCB0aGUgcmVjZWl2ZSBxdWV1ZVxuICAgICAgICBpZiAoclEubGVuZ3RoID4gclFtYXgpIHtcbiAgICAgICAgICAvLyBVdGlsLkRlYnVnKFwiQ29tcGFjdGluZyByZWNlaXZlIHF1ZXVlXCIpO1xuICAgICAgICAgIHJRID0gclEuc2xpY2UoclFpKTtcbiAgICAgICAgICByUWkgPSAwO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBVdGlsLkRlYnVnKCdJZ25vcmluZyBlbXB0eSBtZXNzYWdlJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXhjKSB7XG4gICAgICBpZiAodHlwZW9mIGV4Yy5zdGFjayAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgVXRpbC5XYXJuKCdyZWN2X21lc3NhZ2UsIGNhdWdodCBleGNlcHRpb246ICcgKyBleGMuc3RhY2spO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZXhjLmRlc2NyaXB0aW9uICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBVdGlsLldhcm4oJ3JlY3ZfbWVzc2FnZSwgY2F1Z2h0IGV4Y2VwdGlvbjogJyArIGV4Yy5kZXNjcmlwdGlvbik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBVdGlsLldhcm4oJ3JlY3ZfbWVzc2FnZSwgY2F1Z2h0IGV4Y2VwdGlvbjonICsgZXhjKTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgZXhjLm5hbWUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGV2ZW50SGFuZGxlcnMuZXJyb3IoZXhjLm5hbWUgKyAnOiAnICsgZXhjLm1lc3NhZ2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZXZlbnRIYW5kbGVycy5lcnJvcihleGMpO1xuICAgICAgfVxuICAgIH1cbiAgICAvLyBVdGlsLkRlYnVnKFwiPDwgcmVjdl9tZXNzYWdlXCIpO1xuICB9XG5cbiAgLy8gU2V0IGV2ZW50IGhhbmRsZXJzXG4gIGZ1bmN0aW9uIG9uKGV2dCwgaGFuZGxlcikge1xuICAgIGV2ZW50SGFuZGxlcnNbZXZ0XSA9IGhhbmRsZXI7XG4gIH1cblxuICBmdW5jdGlvbiBpbml0KHByb3RvY29scywgd3Nfc2NoZW1hKSB7XG4gICAgdmFyIGJ0ID0gZmFsc2U7XG4gICAgdmFyIHdzYnQgPSBmYWxzZTtcbiAgICAvLyB2YXIgdHJ5X2JpbmFyeSA9IGZhbHNlO1xuXG4gICAgclEgPSBbXTtcbiAgICByUWkgPSAwO1xuICAgIHNRID0gW107XG4gICAgd2Vic29ja2V0ID0gbnVsbDtcblxuICAgIC8vIENoZWNrIGZvciBmdWxsIHR5cGVkIGFycmF5IHN1cHBvcnRcbiAgICBpZiAoKCdVaW50OEFycmF5JyBpbiB3aW5kb3cpICYmICgnc2V0JyBpbiBVaW50OEFycmF5LnByb3RvdHlwZSkpIHtcbiAgICAgIGJ0ID0gdHJ1ZTtcbiAgICB9XG4gICAgLy8gQ2hlY2sgZm9yIGZ1bGwgYmluYXJ5IHR5cGUgc3VwcG9ydCBpbiBXZWJTb2NrZXRcbiAgICAvLyBJbnNwaXJlZCBieTpcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vTW9kZXJuaXpyL01vZGVybml6ci9pc3N1ZXMvMzcwXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01vZGVybml6ci9Nb2Rlcm5penIvYmxvYi9tYXN0ZXIvZmVhdHVyZS1kZXRlY3RzL3dlYnNvY2tldHMvYmluYXJ5LmpzXG4gICAgdHJ5IHtcbiAgICAgIGlmIChidCAmJiAoJ2JpbmFyeVR5cGUnIGluIFdlYlNvY2tldC5wcm90b3R5cGUgfHxcbiAgICAgICAgICAgICAgICAgICAgICEhKG5ldyBXZWJTb2NrZXQod3Nfc2NoZW1hICsgJzovLy4nKS5iaW5hcnlUeXBlKSkpIHtcbiAgICAgICAgVXRpbC5JbmZvKCdEZXRlY3RlZCBiaW5hcnlUeXBlIHN1cHBvcnQgaW4gV2ViU29ja2V0cycpO1xuICAgICAgICB3c2J0ID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChleGMpIHtcbiAgICAgIC8vIEp1c3QgaWdub3JlIGZhaWxlZCB0ZXN0IGxvY2FsaG9zdCBjb25uZWN0aW9uc1xuICAgIH1cblxuICAgIC8vIERlZmF1bHQgcHJvdG9jb2xzIGlmIG5vdCBzcGVjaWZpZWRcbiAgICBpZiAodHlwZW9mIChwcm90b2NvbHMpID09PSAndW5kZWZpbmVkJykge1xuICAgICAgaWYgKHdzYnQpIHtcbiAgICAgICAgcHJvdG9jb2xzID0gWydiaW5hcnknLCAnYmFzZTY0J107XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwcm90b2NvbHMgPSAnYmFzZTY0JztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiBubyBiaW5hcnkgc3VwcG9ydCwgbWFrZSBzdXJlIGl0IHdhcyBub3QgcmVxdWVzdGVkXG4gICAgaWYgKCF3c2J0KSB7XG4gICAgICBpZiAocHJvdG9jb2xzID09PSAnYmluYXJ5Jykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1dlYlNvY2tldCBiaW5hcnkgc3ViLXByb3RvY29sIHJlcXVlc3RlZCBidXQgbm90IHN1cHBvcnRlZCcpO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiAocHJvdG9jb2xzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgbGV0IG5ld19wcm90b2NvbHMgPSBbXTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb3RvY29scy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChwcm90b2NvbHNbaV0gPT09ICdiaW5hcnknKSB7XG4gICAgICAgICAgICBVdGlsLkVycm9yKCdTa2lwcGluZyB1bnN1cHBvcnRlZCBXZWJTb2NrZXQgYmluYXJ5IHN1Yi1wcm90b2NvbCcpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXdfcHJvdG9jb2xzLnB1c2gocHJvdG9jb2xzW2ldKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5ld19wcm90b2NvbHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHByb3RvY29scyA9IG5ld19wcm90b2NvbHM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPbmx5IFdlYlNvY2tldCBiaW5hcnkgc3ViLXByb3RvY29sIHdhcyByZXF1ZXN0ZWQgYW5kIG5vdCBzdXBwb3J0ZWQuJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHByb3RvY29scztcbiAgfVxuXG4gIGZ1bmN0aW9uIG9wZW4odXJpLCBwcm90b2NvbHMpIHtcbiAgICB2YXIgd3Nfc2NoZW1hID0gdXJpLm1hdGNoKC9eKFthLXpdKyk6XFwvXFwvLylbMV07XG5cbiAgICBwcm90b2NvbHMgPSBpbml0KHByb3RvY29scywgd3Nfc2NoZW1hKTtcbiAgICBpZiAodGVzdF9tb2RlKSB7XG4gICAgICB3ZWJzb2NrZXQgPSB7fTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2Vic29ja2V0ID0gbmV3IFdlYlNvY2tldCh1cmksIHByb3RvY29scyk7XG4gICAgICBpZiAocHJvdG9jb2xzLmluZGV4T2YoJ2JpbmFyeScpID49IDApIHtcbiAgICAgICAgd2Vic29ja2V0LmJpbmFyeVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgfVxuICAgIH1cbiAgICB3ZWJzb2NrZXQub25tZXNzYWdlID0gcmVjdl9tZXNzYWdlO1xuICAgIHdlYnNvY2tldC5vbm9wZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICBVdGlsLkRlYnVnKCc+PiBXZWJTb2NrLm9ub3BlbicpO1xuICAgICAgaWYgKHdlYnNvY2tldC5wcm90b2NvbCkge1xuICAgICAgICBtb2RlID0gd2Vic29ja2V0LnByb3RvY29sO1xuICAgICAgICBVdGlsLkluZm8oJ1NlcnZlciBjaG9zZSBzdWItcHJvdG9jb2w6ICcgKyB3ZWJzb2NrZXQucHJvdG9jb2wpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbW9kZSA9ICdiYXNlNjQnO1xuICAgICAgICBVdGlsLkVycm9yKCdTZXJ2ZXIgc2VsZWN0IG5vIHN1Yi1wcm90b2NvbCE6ICcgKyB3ZWJzb2NrZXQucHJvdG9jb2wpO1xuICAgICAgfVxuICAgICAgZXZlbnRIYW5kbGVycy5vcGVuKCk7XG4gICAgICBVdGlsLkRlYnVnKCdcIjw8IFdlYlNvY2sub25vcGVuJyk7XG4gICAgfTtcbiAgICB3ZWJzb2NrZXQub25jbG9zZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICBVdGlsLkRlYnVnKCc+PiBXZWJTb2NrLm9uY2xvc2UnKTtcbiAgICAgIGV2ZW50SGFuZGxlcnMuY2xvc2UoZSk7XG4gICAgICBVdGlsLkRlYnVnKCc8PCBXZWJTb2NrLm9uY2xvc2UnKTtcbiAgICB9O1xuICAgIHdlYnNvY2tldC5vbmVycm9yID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgIFV0aWwuRGVidWcoJz4+IFdlYlNvY2sub25lcnJvcjogJyArIGUpO1xuICAgICAgZXZlbnRIYW5kbGVycy5lcnJvcihlKTtcbiAgICAgIFV0aWwuRGVidWcoJzw8IFdlYlNvY2sub25lcnJvcicpO1xuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICBpZiAod2Vic29ja2V0KSB7XG4gICAgICBpZiAoKHdlYnNvY2tldC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuT1BFTikgfHxcbiAgICAgICAgICAod2Vic29ja2V0LnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5DT05ORUNUSU5HKSkge1xuICAgICAgICBVdGlsLkluZm8oJ0Nsb3NpbmcgV2ViU29ja2V0IGNvbm5lY3Rpb24nKTtcbiAgICAgICAgd2Vic29ja2V0LmNsb3NlKCk7XG4gICAgICB9XG4gICAgICB3ZWJzb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuOyB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIE92ZXJyaWRlIGludGVybmFsIGZ1bmN0aW9ucyBmb3IgdGVzdGluZ1xuICAvLyBUYWtlcyBhIHNlbmQgZnVuY3Rpb24sIHJldHVybnMgcmVmZXJlbmNlIHRvIHJlY3YgZnVuY3Rpb25cbiAgZnVuY3Rpb24gdGVzdE1vZGUob3ZlcnJpZGVfc2VuZCwgZGF0YV9tb2RlKSB7XG4gICAgdGVzdF9tb2RlID0gdHJ1ZTtcbiAgICBtb2RlID0gZGF0YV9tb2RlO1xuICAgIGFwaS5zZW5kID0gb3ZlcnJpZGVfc2VuZDtcbiAgICBhcGkuY2xvc2UgPSBmdW5jdGlvbiAoKSB7fTtcbiAgICByZXR1cm4gcmVjdl9tZXNzYWdlO1xuICB9XG5cbiAgZnVuY3Rpb24gY29uc3RydWN0b3IoKSB7XG4gICAgLy8gQ29uZmlndXJhdGlvbiBzZXR0aW5nc1xuICAgIGFwaS5tYXhCdWZmZXJlZEFtb3VudCA9IDIwMDtcbiAgICAvLyBEaXJlY3QgYWNjZXNzIHRvIHNlbmQgYW5kIHJlY2VpdmUgcXVldWVzXG4gICAgYXBpLmdldF9zUSAgICAgICA9IGdldF9zUTtcbiAgICBhcGkuZ2V0X3JRICAgICAgID0gZ2V0X3JRO1xuICAgIGFwaS5nZXRfclFpICAgICAgPSBnZXRfclFpO1xuICAgIGFwaS5zZXRfclFpICAgICAgPSBzZXRfclFpO1xuXG4gICAgLy8gUm91dGluZXMgdG8gcmVhZCBmcm9tIHRoZSByZWNlaXZlIHF1ZXVlXG4gICAgYXBpLnJRbGVuICAgICAgICA9IHJRbGVuO1xuICAgIGFwaS5yUXBlZWs4ICAgICAgPSByUXBlZWs4O1xuICAgIGFwaS5yUXNoaWZ0OCAgICAgPSByUXNoaWZ0ODtcbiAgICBhcGkuclF1bnNoaWZ0OCAgID0gclF1bnNoaWZ0ODtcbiAgICBhcGkuclFzaGlmdDE2ICAgID0gclFzaGlmdDE2O1xuICAgIGFwaS5yUXNoaWZ0MzIgICAgPSByUXNoaWZ0MzI7XG4gICAgYXBpLnJRc2hpZnRTdHIgICA9IHJRc2hpZnRTdHI7XG4gICAgYXBpLnJRc2hpZnRCeXRlcyA9IHJRc2hpZnRCeXRlcztcbiAgICBhcGkuclFzbGljZSAgICAgID0gclFzbGljZTtcbiAgICBhcGkuclF3YWl0ICAgICAgID0gclF3YWl0O1xuXG4gICAgYXBpLmZsdXNoICAgICAgICA9IGZsdXNoO1xuICAgIGFwaS5zZW5kICAgICAgICAgPSBzZW5kO1xuICAgIGFwaS5zZW5kX3N0cmluZyAgPSBzZW5kX3N0cmluZztcblxuICAgIGFwaS5vbiAgICAgICAgICAgPSBvbjtcbiAgICBhcGkuaW5pdCAgICAgICAgID0gaW5pdDtcbiAgICBhcGkub3BlbiAgICAgICAgID0gb3BlbjtcbiAgICBhcGkuY2xvc2UgICAgICAgID0gY2xvc2U7XG4gICAgYXBpLnRlc3RNb2RlICAgICA9IHRlc3RNb2RlO1xuXG4gICAgY29uc29sZS5sb2coZ3JlZXRtZSk7XG5cbiAgICByZXR1cm4gYXBpO1xuICB9XG5cbiAgcmV0dXJuIGNvbnN0cnVjdG9yKCk7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9